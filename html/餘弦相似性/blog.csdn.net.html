<html>
 <body>
  <div>
   <div class="article_content clearfix csdn-tracking-statistics" data-dsm="post" data-mod="popu_307" data-pid="blog" id="article_content">
    <div class="markdown_views">
     <h2 id="餘弦相似性">
      餘弦相似性
     </h2>
     <p>
      餘弦的概念對我們來說並不陌生，中學數學就開始接觸餘弦的概念了，在三角形中，餘弦的公式是：
      <br/>
      <img alt="這裡寫圖片描述" src="https://img-blog.csdn.net/20161221221856170?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlvbmVsX2Zlbmdq/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title=""/>
     </p>
     <p>
      <span class="MathJax_Preview">
      </span>
     </p>
     <p aria-readonly="true" class="MathJax_Display" role="textbox">
      <span class="MathJax" id="MathJax-Element-1-Frame">
       <nobr>
        <span class="math" id="MathJax-Span-1">
         <span>
          <span>
           <span class="mrow" id="MathJax-Span-2">
            <span class="mi" id="MathJax-Span-3">
             c
            </span>
            <span class="mi" id="MathJax-Span-4">
             o
            </span>
            <span class="mi" id="MathJax-Span-5">
             s
            </span>
            <span class="mi" id="MathJax-Span-6">
             α
            </span>
            <span class="mo" id="MathJax-Span-7">
             =
            </span>
            <span class="mfrac" id="MathJax-Span-8">
             <span>
              <span>
               <span class="mrow" id="MathJax-Span-9">
                <span class="msubsup" id="MathJax-Span-10">
                 <span>
                  <span>
                   <span class="mi" id="MathJax-Span-11">
                    b
                   </span>
                   <span>
                   </span>
                  </span>
                  <span>
                   <span class="mn" id="MathJax-Span-12">
                    2
                   </span>
                   <span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="mo" id="MathJax-Span-13">
                 +
                </span>
                <span class="msubsup" id="MathJax-Span-14">
                 <span>
                  <span>
                   <span class="mi" id="MathJax-Span-15">
                    c
                   </span>
                   <span>
                   </span>
                  </span>
                  <span>
                   <span class="mn" id="MathJax-Span-16">
                    2
                   </span>
                   <span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="mo" id="MathJax-Span-17">
                 −
                </span>
                <span class="msubsup" id="MathJax-Span-18">
                 <span>
                  <span>
                   <span class="mi" id="MathJax-Span-19">
                    a
                   </span>
                   <span>
                   </span>
                  </span>
                  <span>
                   <span class="mn" id="MathJax-Span-20">
                    2
                   </span>
                   <span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mrow" id="MathJax-Span-21">
                <span class="mn" id="MathJax-Span-22">
                 2
                </span>
                <span class="mi" id="MathJax-Span-23">
                 b
                </span>
                <span class="mi" id="MathJax-Span-24">
                 c
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span>
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-25">
             (
            </span>
            <span class="texatom" id="MathJax-Span-26">
             <span class="mrow" id="MathJax-Span-27">
              <span class="mo" id="MathJax-Span-28">
               <span>
                式
               </span>
              </span>
             </span>
            </span>
            <span class="mn" id="MathJax-Span-29">
             1
            </span>
            <span class="mo" id="MathJax-Span-30">
             −
            </span>
            <span class="mn" id="MathJax-Span-31">
             1
            </span>
            <span class="mo" id="MathJax-Span-32">
             )
            </span>
           </span>
           <span>
           </span>
          </span>
         </span>
         <span>
         </span>
        </span>
       </nobr>
      </span>
     </p>
     <p>
      在向量表示的三角形中，假設向量
      <span class="MathJax_Preview">
      </span>
      <span aria-readonly="true" class="MathJax" id="MathJax-Element-2-Frame" role="textbox">
       <nobr>
        <span class="math" id="MathJax-Span-33">
         <span>
          <span>
           <span class="mrow" id="MathJax-Span-34">
            <span class="texatom" id="MathJax-Span-35">
             <span class="mrow" id="MathJax-Span-36">
              <span class="munderover" id="MathJax-Span-37">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-38">
                  a
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-39">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-40">
             =
            </span>
            <span class="mo" id="MathJax-Span-41">
             (
            </span>
            <span class="msubsup" id="MathJax-Span-42">
             <span>
              <span>
               <span class="mi" id="MathJax-Span-43">
                x
                <span>
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mn" id="MathJax-Span-44">
                1
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-45">
             ,
            </span>
            <span class="msubsup" id="MathJax-Span-46">
             <span>
              <span>
               <span class="mi" id="MathJax-Span-47">
                y
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mn" id="MathJax-Span-48">
                1
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-49">
             )
            </span>
           </span>
           <span>
           </span>
          </span>
         </span>
         <span>
         </span>
        </span>
       </nobr>
      </span>
      ,
      <span class="MathJax_Preview">
      </span>
      <span aria-readonly="true" class="MathJax" id="MathJax-Element-3-Frame" role="textbox">
       <nobr>
        <span class="math" id="MathJax-Span-50">
         <span>
          <span>
           <span class="mrow" id="MathJax-Span-51">
            <span class="texatom" id="MathJax-Span-52">
             <span class="mrow" id="MathJax-Span-53">
              <span class="munderover" id="MathJax-Span-54">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-55">
                  b
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-56">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-57">
             =
            </span>
            <span class="mo" id="MathJax-Span-58">
             (
            </span>
            <span class="msubsup" id="MathJax-Span-59">
             <span>
              <span>
               <span class="mi" id="MathJax-Span-60">
                x
                <span>
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mn" id="MathJax-Span-61">
                2
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-62">
             ,
            </span>
            <span class="msubsup" id="MathJax-Span-63">
             <span>
              <span>
               <span class="mi" id="MathJax-Span-64">
                y
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mn" id="MathJax-Span-65">
                2
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-66">
             )
            </span>
           </span>
           <span>
           </span>
          </span>
         </span>
         <span>
         </span>
        </span>
       </nobr>
      </span>
      則向量
      <span class="MathJax_Preview">
      </span>
      <span aria-readonly="true" class="MathJax" id="MathJax-Element-4-Frame" role="textbox">
       <nobr>
        <span class="math" id="MathJax-Span-67">
         <span>
          <span>
           <span class="mrow" id="MathJax-Span-68">
            <span class="texatom" id="MathJax-Span-69">
             <span class="mrow" id="MathJax-Span-70">
              <span class="munderover" id="MathJax-Span-71">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-72">
                  a
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-73">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-74">
             ,
            </span>
            <span class="texatom" id="MathJax-Span-75">
             <span class="mrow" id="MathJax-Span-76">
              <span class="mo" id="MathJax-Span-77">
               <span>
                和
               </span>
              </span>
             </span>
            </span>
            <span class="texatom" id="MathJax-Span-78">
             <span class="mrow" id="MathJax-Span-79">
              <span class="mo" id="MathJax-Span-80">
               <span>
                向
               </span>
              </span>
             </span>
            </span>
            <span class="texatom" id="MathJax-Span-81">
             <span class="mrow" id="MathJax-Span-82">
              <span class="mo" id="MathJax-Span-83">
               <span>
                量
               </span>
              </span>
             </span>
            </span>
            <span class="texatom" id="MathJax-Span-84">
             <span class="mrow" id="MathJax-Span-85">
              <span class="munderover" id="MathJax-Span-86">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-87">
                  b
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-88">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span>
           </span>
          </span>
         </span>
         <span>
         </span>
        </span>
       </nobr>
      </span>
      的夾角的餘弦為：
      <br/>
      <span class="MathJax_Preview">
      </span>
     </p>
     <p aria-readonly="true" class="MathJax_Display" role="textbox">
      <span class="MathJax" id="MathJax-Element-5-Frame">
       <nobr>
        <span class="math" id="MathJax-Span-89">
         <span>
          <span>
           <span class="mrow" id="MathJax-Span-90">
            <span class="mi" id="MathJax-Span-91">
             c
            </span>
            <span class="mi" id="MathJax-Span-92">
             o
            </span>
            <span class="mi" id="MathJax-Span-93">
             s
            </span>
            <span class="texatom" id="MathJax-Span-94">
             <span class="mrow" id="MathJax-Span-95">
              <span class="mo" id="MathJax-Span-96">
               <span>
                （
               </span>
              </span>
             </span>
            </span>
            <span class="texatom" id="MathJax-Span-97">
             <span class="mrow" id="MathJax-Span-98">
              <span class="munderover" id="MathJax-Span-99">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-100">
                  a
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-101">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-102">
             ,
            </span>
            <span class="texatom" id="MathJax-Span-103">
             <span class="mrow" id="MathJax-Span-104">
              <span class="munderover" id="MathJax-Span-105">
               <span>
                <span>
                 <span class="mi" id="MathJax-Span-106">
                  b
                 </span>
                 <span>
                 </span>
                </span>
                <span>
                 <span>
                 </span>
                 <span class="mo" id="MathJax-Span-107">
                  ⃗
                  <span>
                  </span>
                 </span>
                 <span>
                 </span>
                 <span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="texatom" id="MathJax-Span-108">
             <span class="mrow" id="MathJax-Span-109">
              <span class="mo" id="MathJax-Span-110">
               <span>
                ）
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-111">
             =
            </span>
            <span class="mfrac" id="MathJax-Span-112">
             <span>
              <span>
               <span class="mrow" id="MathJax-Span-113">
                <span class="texatom" id="MathJax-Span-114">
                 <span class="mrow" id="MathJax-Span-115">
                  <span class="munderover" id="MathJax-Span-116">
                   <span>
                    <span>
                     <span class="mi" id="MathJax-Span-117">
                      a
                     </span>
                     <span>
                     </span>
                    </span>
                    <span>
                     <span>
                     </span>
                     <span class="mo" id="MathJax-Span-118">
                      ⃗
                      <span>
                      </span>
                     </span>
                     <span>
                     </span>
                     <span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="mo" id="MathJax-Span-119">
                 ⋅
                </span>
                <span class="texatom" id="MathJax-Span-120">
                 <span class="mrow" id="MathJax-Span-121">
                  <span class="munderover" id="MathJax-Span-122">
                   <span>
                    <span>
                     <span class="mi" id="MathJax-Span-123">
                      b
                     </span>
                     <span>
                     </span>
                    </span>
                    <span>
                     <span>
                     </span>
                     <span class="mo" id="MathJax-Span-124">
                      ⃗
                      <span>
                      </span>
                     </span>
                     <span>
                     </span>
                     <span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span class="mrow" id="MathJax-Span-125">
                <span class="texatom" id="MathJax-Span-126">
                 <span class="mrow" id="MathJax-Span-127">
                  <span class="mo" id="MathJax-Span-128">
                   |
                  </span>
                 </span>
                </span>
                <span class="mi" id="MathJax-Span-129">
                 a
                </span>
                <span class="texatom" id="MathJax-Span-130">
                 <span class="mrow" id="MathJax-Span-131">
                  <span class="mo" id="MathJax-Span-132">
                   |
                  </span>
                 </span>
                </span>
                <span class="texatom" id="MathJax-Span-133">
                 <span class="mrow" id="MathJax-Span-134">
                  <span class="mo" id="MathJax-Span-135">
                   |
                  </span>
                 </span>
                </span>
                <span class="mi" id="MathJax-Span-136">
                 b
                </span>
                <span class="texatom" id="MathJax-Span-137">
                 <span class="mrow" id="MathJax-Span-138">
                  <span class="mo" id="MathJax-Span-139">
                   |
                  </span>
                 </span>
                </span>
               </span>
               <span>
               </span>
              </span>
              <span>
               <span>
               </span>
               <span>
               </span>
              </span>
             </span>
            </span>
            <span class="mo" id="MathJax-Span-140">
             (
            </span>
            <span class="texatom" id="MathJax-Span-141">
             <span class="mrow" id="MathJax-Span-142">
              <span class="mo" id="MathJax-Span-143">
               <span>
                式
               </span>
              </span>
             </span>
            </span>
            <span class="mn" id="MathJax-Span-144">
             1
            </span>
            <span class="mo" id="MathJax-Span-145">
             −
            </span>
            <span class="mn" id="MathJax-Span-146">
             2
            </span>
            <span class="mo" id="MathJax-Span-147">
             )
            </span>
           </span>
           <span>
           </span>
          </span>
         </span>
         <span>
         </span>
        </span>
       </nobr>
      </span>
     </p>
     <p>
      餘弦有這樣的性質：餘弦值越接近1，就表明夾角越接近0度，也就是兩個向量越相似，夾角等於0，即兩個向量相等，這就叫”餘弦相似性”。
     </p>
     <p>
      那麼該怎麼利用餘弦來計算文字的相似性了？首先來看一個例子。
     </p>
     <p>
      文字1：我們喜歡足球
      <br/>
      文字2：我喜歡踢足球
     </p>
     <p>
      大致思路是：我們認為問用詞越相似，則文字的相似度越高，所以計算文字相似性主要按照以下步驟進行：
     </p>
     <ol>
      <li>
       <p>
        分詞
        <br/>
        此處利用 ansj 分詞工具進行分詞，文字1和文字2的分詞結果為：
        <br/>
        文字1：我/喜歡/足球
        <br/>
        文字2：我們/喜歡/踢/足球
       </p>
      </li>
      <li>
       <p>
        列出所有的詞
        <br/>
        我, 喜歡, 踢, 我們, 足球
       </p>
      </li>
      <li>
       <p>
        計算詞頻
        <br/>
        文字1： 我：1，喜歡：1，踢：0，我們：0，足球：1
        <br/>
        文字2： 我：0，喜歡：1，踢：1，我們：1，足球：1
       </p>
      </li>
      <li>
       <p>
        轉化為向量
        <br/>
        文字1：[1, 1, 0, 0, 1]
        <br/>
        文字2：[0, 1, 1, 1, 1]
       </p>
      </li>
     </ol>
     <h3 id="程式碼示例">
      程式碼示例
     </h3>
     <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.myapp.ml.nlp;

<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-javadoc">/**
 * Created by lionel on 16/12/21.
 */</span>
<span class="hljs-annotation">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordValue</span> {</span>
    <span class="hljs-keyword">private</span> String word;
    <span class="hljs-keyword">private</span> Integer frequecy;

    <span class="hljs-keyword">public</span> <span class="hljs-title">WordValue</span>() {
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title">WordValue</span>(String word, Integer frequecy) {
        <span class="hljs-keyword">this</span>.word = word;
        <span class="hljs-keyword">this</span>.frequecy = frequecy;
    }

}</code></pre>
     <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.myapp.ml.nlp;

<span class="hljs-keyword">import</span> org.ansj.domain.Term;
<span class="hljs-keyword">import</span> org.ansj.splitWord.analysis.ToAnalysis;
<span class="hljs-keyword">import</span> org.ansj.util.FilterModifWord;
<span class="hljs-keyword">import</span> org.apache.commons.lang3.StringUtils;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.HashSet;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-javadoc">/**
 * Created by lionel on 16/12/21.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CosineSimilarity</span> {</span>
    <span class="hljs-javadoc">/**
     * 向量餘弦
     *
     *<span class="hljs-javadoctag"> @param</span> text1 文字1
     *<span class="hljs-javadoctag"> @param</span> text2 文字2
     *<span class="hljs-javadoctag"> @return</span> 向量餘弦
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">cos</span>(String text1, String text2) {
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(text2 + text1)) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span>;
        }
        List&lt;String&gt; words = parse(text1);
        List&lt;String&gt; words1 = parse(text2);
        Set&lt;String&gt; set = mergeList(words, words1);
        List&lt;WordValue&gt; wordValueList = computeWordCount(words);
        List&lt;WordValue&gt; wordValueList1 = computeWordCount(words1);
        <span class="hljs-keyword">int</span>[] vector = wordToVector(set, wordValueList);
        <span class="hljs-keyword">int</span>[] vector1 = wordToVector(set, wordValueList1);
        <span class="hljs-keyword">int</span> moduleA = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">int</span> moduleB = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">int</span> AMutiplyB = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; vector.length; i++) {
            moduleA += vector[i] * vector[i];
            moduleB += vector1[i] * vector1[i];
            AMutiplyB += vector[i] * vector1[i];
        }
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">double</span>) AMutiplyB / (Math.sqrt(moduleA) * Math.sqrt(moduleB));

    }

    <span class="hljs-javadoc">/**
     * 轉化為向量
     *
     *<span class="hljs-javadoctag"> @param</span> set  所有的詞表
     *<span class="hljs-javadoctag"> @param</span> list 詞資訊
     *<span class="hljs-javadoctag"> @return</span> 向量
     */</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] <span class="hljs-title">wordToVector</span>(Set&lt;String&gt; set, List&lt;WordValue&gt; list) {
        <span class="hljs-keyword">if</span> (set == <span class="hljs-keyword">null</span> || set.size() == <span class="hljs-number">0</span> || list == <span class="hljs-keyword">null</span> || list.size() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
        }
        List&lt;String&gt; mergeList = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;(set);
        <span class="hljs-keyword">int</span>[] vector = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[mergeList.size()];

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; mergeList.size(); i++) {
            <span class="hljs-keyword">for</span> (WordValue wordValue : list) {
                <span class="hljs-keyword">if</span> (wordValue.getWord().equals(mergeList.get(i))) {
                    vector[i] = wordValue.getFrequecy();
                    <span class="hljs-keyword">break</span>;
                } <span class="hljs-keyword">else</span> {
                    vector[i] = <span class="hljs-number">0</span>;
                }
            }
        }
        <span class="hljs-keyword">return</span> vector;
    }

    <span class="hljs-javadoc">/**
     * 分詞
     *
     *<span class="hljs-javadoctag"> @param</span> text 文字
     *<span class="hljs-javadoctag"> @return</span> 分詞結果
     */</span>

    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title">parse</span>(String text) {
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(text)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
        }

        List&lt;Term&gt; terms = FilterModifWord.modifResult(ToAnalysis.parse(text));
        <span class="hljs-keyword">if</span> (terms == <span class="hljs-keyword">null</span> || terms.size() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
        }
        List&lt;String&gt; words = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;();
        <span class="hljs-keyword">for</span> (Term term : terms) {
            <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(term.getName())) {
                words.add(term.getName());
            }
        }
        <span class="hljs-keyword">return</span> words;
    }

    <span class="hljs-javadoc">/**
     * 獲取所有的詞
     *
     *<span class="hljs-javadoctag"> @param</span> str1 文字1分詞結果
     *<span class="hljs-javadoctag"> @param</span> str2 文字2分詞結果
     *<span class="hljs-javadoctag"> @return</span> 返回所有的詞，不重複
     */</span>

    <span class="hljs-keyword">private</span> Set&lt;String&gt; <span class="hljs-title">mergeList</span>(List&lt;String&gt; str1, List&lt;String&gt; str2) {
        <span class="hljs-keyword">if</span> (str1 == <span class="hljs-keyword">null</span> || str1.size() == <span class="hljs-number">0</span>
                || str2 == <span class="hljs-keyword">null</span> || str2.size() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
        }
        Set&lt;String&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;String&gt;();
        <span class="hljs-keyword">for</span> (String ele : str1) {
            set.add(ele);
        }
        <span class="hljs-keyword">for</span> (String ele : str2) {
            set.add(ele);
        }
        <span class="hljs-keyword">return</span> set;
    }

    <span class="hljs-javadoc">/**
     * 計算詞頻
     *
     *<span class="hljs-javadoctag"> @param</span> list 分詞結果
     *<span class="hljs-javadoctag"> @return</span> 詞頻
     */</span>

    <span class="hljs-keyword">private</span> List&lt;WordValue&gt; <span class="hljs-title">computeWordCount</span>(List&lt;String&gt; list) {
        List&lt;WordValue&gt; wordValueList = <span class="hljs-keyword">new</span> ArrayList&lt;WordValue&gt;();
        <span class="hljs-keyword">for</span> (String element : list) {
            <span class="hljs-keyword">if</span> (isInWordValueList(element, wordValueList)) {
                WordValue wordValue = wordValueList.get(getElementIndex(element, wordValueList));
                wordValue.setFrequecy(wordValue.getFrequecy() + <span class="hljs-number">1</span>);
            } <span class="hljs-keyword">else</span> {
                WordValue wordValue = <span class="hljs-keyword">new</span> WordValue(element, <span class="hljs-number">1</span>);
                wordValueList.add(wordValue);
            }
        }
        <span class="hljs-keyword">return</span> wordValueList;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getElementIndex</span>(String word, List&lt;WordValue&gt; wordValueList) {
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(word) || wordValueList == <span class="hljs-keyword">null</span> || wordValueList.size() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; wordValueList.size(); i++) {
            <span class="hljs-keyword">if</span> (wordValueList.get(i).getWord().equals(word)) {
                <span class="hljs-keyword">return</span> i;
            }
        }
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isInWordValueList</span>(String str, List&lt;WordValue&gt; wordValueList) {
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(str) || wordValueList == <span class="hljs-keyword">null</span> || wordValueList.size() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">for</span> (WordValue wordValue : wordValueList) {
            <span class="hljs-keyword">if</span> (wordValue.getWord().equals(str)) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
}</code></pre>
     <p>
      測試程式碼
     </p>
     <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.myapp.ml.nlp;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-javadoc">/**
 * Created by lionel on 16/12/21.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CosineSimilarityTest</span> {</span>
    <span class="hljs-annotation">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span>() {
        String text = <span class="hljs-string">"我喜歡足球"</span>;
        String text1 = <span class="hljs-string">"我們喜歡踢足球"</span>;
        CosineSimilarity cosineSimilarity = <span class="hljs-keyword">new</span> CosineSimilarity();
        System.out.println(cosineSimilarity.cos(text, text1));
    }
}
</code></pre>
     <p>
      以上程式結果是0.5773502691896258，經驗證結果是正確的。
      <br/>
      注意：以上程式只符合簡單的應用情況,不適用複雜的情況。另外，餘弦相似性還可以用來判別文件的相似性，大致思路是：首先求出文件的關鍵詞（可以利用 TF-IDF 方法），以後可以按照以上2，3，4步驟進行計算。
     </p>
    </div>
   </div>
  </div>
 </body>
</html>